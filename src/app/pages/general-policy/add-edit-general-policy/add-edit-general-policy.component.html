<div class="card">
  <p-toast></p-toast>
  
  <form [formGroup]="policyForm" (ngSubmit)="onSubmit()">
    <!-- General Panel -->
    <p-panel [header]="'policies.form.title' | translate" [toggleable]="true">
      <div class="policy-form-grid">

        <!-- Name -->
        <div class="form-field">
          <label for="nameEn" class="required">{{ 'policies.form.nameEn' | translate }} <i class="pi pi-question-circle" [pTooltip]="'policies.form.tooltips.name' | translate"></i></label>
          <input id="nameEn" type="text" pInputText formControlName="nameEn" [placeholder]="'policies.form.nameEn' | translate">
        </div>

        <div class="form-field">
          <label for="nameAr" class="required">{{ 'policies.form.nameAr' | translate }} <i class="pi pi-question-circle" [pTooltip]="'policies.form.tooltips.nameAr' | translate"></i></label>
          <input id="nameAr" type="text" pInputText formControlName="nameAr" [placeholder]="'policies.form.nameAr' | translate">
        </div>

        <div class="form-field checkbox-field">
          <p-checkbox formControlName="isActive" [binary]="true" inputId="isActive"></p-checkbox>
          <label for="isActive">{{ 'policies.form.isActive' | translate }} <i class="pi pi-question-circle" [pTooltip]="'policies.form.tooltips.isActive' | translate"></i></label>
        </div>

        <div class="form-field checkbox-field">
          <p-checkbox formControlName="isDefault" [binary]="true" inputId="isDefault"></p-checkbox>
          <label for="isDefault">{{ 'policies.form.isDefault' | translate }} <i class="pi pi-question-circle" [pTooltip]="'policies.form.tooltips.isDefault' | translate"></i></label>
        </div>

        <!-- Punch Settings -->
        <div class="section-title">{{ 'policies.form.sections.punchSettings' | translate }}</div>
        <div class="form-field">
          <label for="punchRequirementModeId">{{ 'policies.form.punchRequirement' | translate }}<i class="pi pi-question-circle" [pTooltip]="'policies.form.tooltips.punchRequirement' | translate"></i></label>
          <p-select inputId="punchRequirementModeId" [options]="punchRequirementModes" formControlName="punchRequirementModeId" optionLabel="label" optionValue="value"></p-select>
        </div>
        <div class="form-field checkbox-field"><p-checkbox formControlName="isMobilePunchEnabled" [binary]="true" inputId="isMobilePunchEnabled"></p-checkbox><label for="isMobilePunchEnabled" class="required">{{ 'policies.form.mobileCheckInOut' | translate }} <i class="pi pi-question-circle" [pTooltip]="'policies.form.tooltips.mobileCheckInOut' | translate"></i></label></div>
        <div class="form-field checkbox-field"><p-checkbox formControlName="isWebPunchEnabled" [binary]="true" inputId="isWebPunchEnabled"></p-checkbox><label for="isWebPunchEnabled" class="required">{{ 'policies.form.webCheckInOut' | translate }} <i class="pi pi-question-circle" [pTooltip]="'policies.form.tooltips.webCheckInOut' | translate"></i></label></div>
        <div class="form-field checkbox-field"><p-checkbox formControlName="isAbsentDueToFirstPunchInAfterShift" [binary]="true" inputId="isAbsentDueToFirstPunchInAfterShift"></p-checkbox><label for="isAbsentDueToFirstPunchInAfterShift" class="required">{{ 'policies.form.absentAfterDuty' | translate }} <i class="pi pi-question-circle" [pTooltip]="'policies.form.tooltips.absentAfterDuty' | translate"></i></label></div>
        <div class="form-field checkbox-field"><p-checkbox formControlName="isAbsentDueToLastPunchOutBeforeShift" [binary]="true" inputId="isAbsentDueToLastPunchOutBeforeShift"></p-checkbox><label for="isAbsentDueToLastPunchOutBeforeShift">{{ 'policies.form.absentBeforeDuty' | translate }}<i class="pi pi-question-circle" [pTooltip]="'policies.form.tooltips.absentBeforeDuty' | translate"></i></label></div>

        <!-- Grace Period Section -->
        <div class="section-title">{{ 'policies.form.sections.gracePeriod' | translate }}</div>
        <div class="form-field"><label for="lateGracePeriod" class="required">{{ 'policies.form.late' | translate }} <i class="pi pi-question-circle" [pTooltip]="'policies.form.tooltips.late' | translate"></i></label><p-inputNumber formControlName="lateGracePeriod" inputId="lateGracePeriod" [min]="0" suffix=" Mins" [useGrouping]="false"></p-inputNumber></div>
        <div class="form-field"><label for="earlyGracePeriod" class="required">{{ 'policies.form.early' | translate }} <i class="pi pi-question-circle" [pTooltip]="'policies.form.tooltips.early' | translate"></i></label><p-inputNumber formControlName="earlyGracePeriod" inputId="earlyGracePeriod" [min]="0" suffix=" Mins" [useGrouping]="false"></p-inputNumber></div>
        <div class="form-field"><label for="lateMaxToMarkAsAbsent" class="required">{{ 'policies.form.lateExceeds' | translate }} <i class="pi pi-question-circle" [pTooltip]="'policies.form.tooltips.lateExceeds' | translate"></i></label><p-inputNumber formControlName="lateMaxToMarkAsAbsent" inputId="lateMaxToMarkAsAbsent" [min]="0" suffix=" Mins" [useGrouping]="false"></p-inputNumber></div>
        <div class="form-field"><label for="earlyMaxToMarkAsAbsent" class="required">{{ 'policies.form.earlyExceeds' | translate }} <i class="pi pi-question-circle" [pTooltip]="'policies.form.tooltips.earlyExceeds' | translate"></i></label><p-inputNumber formControlName="earlyMaxToMarkAsAbsent" inputId="earlyMaxToMarkAsAbsent" [min]="0" suffix=" Mins" [useGrouping]="false"></p-inputNumber></div>
        <div class="form-field"><label for="monthlyLateGrace" class="required">{{ 'policies.form.monthlyLateGrace' | translate }} <i class="pi pi-question-circle" [pTooltip]="'policies.form.tooltips.monthlyLateGrace' | translate"></i></label><p-inputNumber formControlName="monthlyLateGrace" inputId="monthlyLateGrace" [min]="0" suffix=" Mins" [useGrouping]="false"></p-inputNumber></div>
        <div class="form-field"><label for="roundOffValue">{{ 'policies.form.roundOff' | translate }}<i class="pi pi-question-circle" [pTooltip]="'policies.form.tooltips.roundOff' | translate"></i></label><p-inputNumber formControlName="roundOffValue" inputId="roundOffValue" [min]="0" suffix=" Mins" [useGrouping]="false"></p-inputNumber></div>
        <div class="form-field"><label for="lateGracePeriodForDoubleShiftTypeId">{{ 'policies.form.lateGraceDouble' | translate }}<i class="pi pi-question-circle" [pTooltip]="'policies.form.tooltips.lateGraceDouble' | translate"></i></label><p-select inputId="lateGracePeriodForDoubleShiftTypeId" [options]="doubleShiftTypes" formControlName="lateGracePeriodForDoubleShiftTypeId" optionLabel="label" optionValue="value" [placeholder]="'common.placeholders.selectType' | translate"></p-select></div>
        <div class="form-field"><label for="earlyGracePeriodForDoubleShiftTypeId">{{ 'policies.form.earlyGraceDouble' | translate }}<i class="pi pi-question-circle" [pTooltip]="'policies.form.tooltips.earlyGraceDouble' | translate"></i></label><p-select inputId="earlyGracePeriodForDoubleShiftTypeId" [options]="doubleShiftTypes" formControlName="earlyGracePeriodForDoubleShiftTypeId" optionLabel="label" optionValue="value" [placeholder]="'common.placeholders.selectType' | translate"></p-select></div>

        <!-- Calculation Settings Section -->
        <div class="section-title">{{ 'policies.form.sections.calculationSettings' | translate }}</div>
        <div class="form-field checkbox-field"><p-checkbox formControlName="validateCheckIn" [binary]="true" inputId="validateCheckIn"></p-checkbox><label for="validateCheckIn" class="required">{{ 'policies.form.validateCheckIn' | translate }} <i class="pi pi-question-circle" [pTooltip]="'policies.form.tooltips.validateCheckIn' | translate"></i></label></div>
        <div class="form-field checkbox-field"><p-checkbox formControlName="validateCheckOut" [binary]="true" inputId="validateCheckOut"></p-checkbox><label for="validateCheckOut" class="required">{{ 'policies.form.validateCheckOut' | translate }} <i class="pi pi-question-circle" [pTooltip]="'policies.form.tooltips.validateCheckOut' | translate"></i></label></div>
        <div class="form-field checkbox-field"><p-checkbox formControlName="calcLateAfterGracePeriod" [binary]="true" inputId="calcLateAfterGracePeriod"></p-checkbox><label for="calcLateAfterGracePeriod" class="required">{{ 'policies.form.calcLateAfterGrace' | translate }} <i class="pi pi-question-circle" [pTooltip]="'policies.form.tooltips.calcLateAfterGrace' | translate"></i></label></div>
        <div class="form-field checkbox-field"><p-checkbox formControlName="calcEarlyAfterGracePeriod" [binary]="true" inputId="calcEarlyAfterGracePeriod"></p-checkbox><label for="calcEarlyAfterGracePeriod" class="required">{{ 'policies.form.calcEarlyBeforeGrace' | translate }} <i class="pi pi-question-circle" [pTooltip]="'policies.form.tooltips.calcEarlyBeforeGrace' | translate"></i></label></div>
        <div class="form-field composite-field"><div class="sub-field"><label for="allocatedWorkHoursTypeId" class="required">{{ 'policies.form.allocatedHoursType' | translate }} <i class="pi pi-question-circle" [pTooltip]="'policies.form.tooltips.allocatedHoursType' | translate"></i></label><p-select inputId="allocatedWorkHoursTypeId" [options]="allocatedWorkHoursTypeList" formControlName="allocatedWorkHoursTypeId" optionLabel="label" optionValue="value"></p-select></div><div class="sub-field"><label for="allocatedWorkHoursValue" class="required">{{ 'policies.form.allocatedHours' | translate }} <i class="pi pi-question-circle" [pTooltip]="'policies.form.tooltips.allocatedHours' | translate"></i></label><p-inputNumber formControlName="allocatedWorkHoursValue" inputId="allocatedWorkHoursValue" [min]="0" suffix=" Hrs" [useGrouping]="false"></p-inputNumber></div></div>
        <div class="form-field"><label for="breakMinutesToDeduct" class="required">{{ 'policies.form.deductBreak' | translate }} <i class="pi pi-question-circle" [pTooltip]="'policies.form.tooltips.deductBreak' | translate"></i></label><p-inputNumber formControlName="breakMinutesToDeduct" inputId="breakMinutesToDeduct" [min]="0" suffix=" Mins" [useGrouping]="false"></p-inputNumber></div>
        <div class="form-field checkbox-field"><p-checkbox formControlName="firstInLastOut" [binary]="true" inputId="firstInLastOut"></p-checkbox><label for="firstInLastOut" class="required">{{ 'policies.form.workHoursBasedOnInOut' | translate }} <i class="pi pi-question-circle" [pTooltip]="'policies.form.tooltips.workHoursBasedOnInOut' | translate"></i></label></div>
        <div class="form-field checkbox-field"><p-checkbox formControlName="workHoursFromShiftStartTime" [binary]="true" inputId="workHoursFromShiftStartTime"></p-checkbox><label for="workHoursFromShiftStartTime" class="required">{{ 'policies.form.workHoursFromShiftStart' | translate }} <i class="pi pi-question-circle" [pTooltip]="'policies.form.tooltips.workHoursFromShiftStart' | translate"></i></label></div>
        <div class="form-field checkbox-field"><p-checkbox formControlName="whContinuousAbsenceCalc" [binary]="true" inputId="whContinuousAbsenceCalc"></p-checkbox><label for="whContinuousAbsenceCalc" class="required">{{ 'policies.form.continuousAbsence' | translate }} <i class="pi pi-question-circle" [pTooltip]="'policies.form.tooltips.continuousAbsence' | translate"></i></label></div>
        <div class="form-field checkbox-field"><p-checkbox formControlName="calcActualWorkHours" [binary]="true" inputId="calcActualWorkHours"></p-checkbox><label for="calcActualWorkHours">{{ 'policies.form.calcActualWorkHours' | translate }}<i class="pi pi-question-circle" [pTooltip]="'policies.form.tooltips.calcActualWorkHours' | translate"></i></label></div>
        <div class="form-field"><label for="shiftOptionId" class="required">{{ 'policies.form.shiftOption' | translate }} <i class="pi pi-question-circle" [pTooltip]="'policies.form.tooltips.shiftOption' | translate"></i></label><p-select inputId="shiftOptionId" [options]="shiftOptionList" formControlName="shiftOptionId" optionLabel="label" optionValue="value"></p-select></div>
        <div class="form-field"><label for="earlyLeavingCalcId" class="required">{{ 'policies.form.earlyLeavingCalc' | translate }} <i class="pi pi-question-circle" [pTooltip]="'policies.form.tooltips.earlyLeavingCalc' | translate"></i></label><p-select inputId="earlyLeavingCalcId" [options]="earlyLeavingOptionList" formControlName="earlyLeavingCalcId" optionLabel="label" optionValue="value"></p-select></div>
        <div class="form-field"><label for="intervalBetweenPunches" class="required">{{ 'policies.form.intervalBetweenPunches' | translate }} <i class="pi pi-question-circle" [pTooltip]="'policies.form.tooltips.intervalBetweenPunches' | translate"></i></label><p-inputNumber formControlName="intervalBetweenPunches" inputId="intervalBetweenPunches" [min]="0" suffix=" Mins" [useGrouping]="false"></p-inputNumber></div>
        <div class="form-field checkbox-field"><p-checkbox formControlName="workHoursCalcOnlyForCheckInOut" [binary]="true" inputId="workHoursCalcOnlyForCheckInOut"></p-checkbox><label for="workHoursCalcOnlyForCheckInOut">{{ 'policies.form.workHoursCalcOnlyInOut' | translate }}<i class="pi pi-question-circle" [pTooltip]="'policies.form.tooltips.workHoursCalcOnlyInOut' | translate"></i></label></div>
        <div class="form-field checkbox-field"><p-checkbox formControlName="reduceMidLateFromRegularHours" [binary]="true" inputId="reduceMidLateFromRegularHours"></p-checkbox><label for="reduceMidLateFromRegularHours">{{ 'policies.form.reduceMidLate' | translate }}<i class="pi pi-question-circle" [pTooltip]="'policies.form.tooltips.reduceMidLate' | translate"></i></label></div>
        <div class="form-field"><label for="allocatedWorkHoursTemplateId">{{ 'policies.form.workHoursTemplate' | translate }}<i class="pi pi-question-circle" [pTooltip]="'policies.form.tooltips.workHoursTemplate' | translate"></i></label><p-select inputId="allocatedWorkHoursTemplateId" [options]="workHourTemplates" formControlName="allocatedWorkHoursTemplateId" optionLabel="label" optionValue="value" [placeholder]="'common.placeholders.selectTemplate' | translate"></p-select></div>

        <!-- Exclusion Section -->
        <div class="section-title">{{ 'policies.form.sections.exclusions' | translate }}</div>
        <div class="form-field"><label for="excludeLateGracePeriodShiftIds">{{ 'policies.form.excludeLateGraceShifts' | translate }} <i class="pi pi-question-circle" [pTooltip]="'policies.form.tooltips.excludeLateGraceShifts' | translate"></i></label><p-multiSelect inputId="excludeLateGracePeriodShiftIds" [options]="filteredShifts" formControlName="excludeLateGracePeriodShiftIds" [placeholder]="'common.placeholders.selectShifts' | translate" optionLabel="shiftTypeName" optionValue="id" (onFilter)="onFilterShifts($event)"></p-multiSelect></div>
        <div class="form-field"><label for="excludeLateGracePeriodShiftTypes">{{ 'policies.form.excludeLateGraceShiftTypes' | translate }}<i class="pi pi-question-circle" [pTooltip]="'policies.form.tooltips.excludeLateGraceShiftTypes' | translate"></i></label><p-multiSelect inputId="excludeLateGracePeriodShiftTypes" [options]="shiftTypes" formControlName="excludeLateGracePeriodShiftTypes" [placeholder]="'common.placeholders.selectShiftTypes' | translate" optionLabel="label" optionValue="value"></p-multiSelect></div>
        <div class="form-field"><label for="excludeEarlyGracePeriodShiftIds">{{ 'policies.form.excludeEarlyGraceShifts' | translate }} <i class="pi pi-question-circle" [pTooltip]="'policies.form.tooltips.excludeEarlyGraceShifts' | translate"></i></label><p-multiSelect inputId="excludeEarlyGracePeriodShiftIds" [options]="filteredShifts" formControlName="excludeEarlyGracePeriodShiftIds" [placeholder]="'common.placeholders.selectShifts' | translate" optionLabel="shiftTypeName" optionValue="id" (onFilter)="onFilterShifts($event)"></p-multiSelect></div>
        <div class="form-field"><label for="excludeEarlyGracePeriodShiftTypes">{{ 'policies.form.excludeEarlyGraceShiftTypes' | translate }}<i class="pi pi-question-circle" [pTooltip]="'policies.form.tooltips.excludeEarlyGraceShiftTypes' | translate"></i></label><p-multiSelect inputId="excludeEarlyGracePeriodShiftTypes" [options]="shiftTypes" formControlName="excludeEarlyGracePeriodShiftTypes" [placeholder]="'common.placeholders.selectShiftTypes' | translate" optionLabel="label" optionValue="value"></p-multiSelect></div>
        <div class="form-field"><label for="excludeLateCalcPeriodShiftIds">{{ 'policies.form.excludeLateCalcShifts' | translate }}<i class="pi pi-question-circle" [pTooltip]="'policies.form.tooltips.excludeLateCalcShifts' | translate"></i></label><p-multiSelect inputId="excludeLateCalcPeriodShiftIds" [options]="filteredShifts" formControlName="excludeLateCalcPeriodShiftIds" [placeholder]="'common.placeholders.selectShifts' | translate" optionLabel="shiftTypeName" optionValue="id" (onFilter)="onFilterShifts($event)"></p-multiSelect></div>
        <div class="form-field"><label for="excludeLateCalcPeriodShiftTypes">{{ 'policies.form.excludeLateCalcShiftTypes' | translate }}<i class="pi pi-question-circle" [pTooltip]="'policies.form.tooltips.excludeLateCalcShiftTypes' | translate"></i></label><p-multiSelect inputId="excludeLateCalcPeriodShiftTypes" [options]="shiftTypes" formControlName="excludeLateCalcPeriodShiftTypes" [placeholder]="'common.placeholders.selectShiftTypes' | translate" optionLabel="label" optionValue="value"></p-multiSelect></div>
        <div class="form-field"><label for="excludeEarlyCalcPeriodShiftIds">{{ 'policies.form.excludeEarlyCalcShifts' | translate }}<i class="pi pi-question-circle" [pTooltip]="'policies.form.tooltips.excludeEarlyCalcShifts' | translate"></i></label><p-multiSelect inputId="excludeEarlyCalcPeriodShiftIds" [options]="filteredShifts" formControlName="excludeEarlyCalcPeriodShiftIds" [placeholder]="'common.placeholders.selectShifts' | translate" optionLabel="shiftTypeName" optionValue="id" (onFilter)="onFilterShifts($event)"></p-multiSelect></div>
        <div class="form-field"><label for="excludeEarlyCalcPeriodShiftTypes">{{ 'policies.form.excludeEarlyCalcShiftTypes' | translate }}<i class="pi pi-question-circle" [pTooltip]="'policies.form.tooltips.excludeEarlyCalcShiftTypes' | translate"></i></label><p-multiSelect inputId="excludeEarlyCalcPeriodShiftTypes" [options]="shiftTypes" formControlName="excludeEarlyCalcPeriodShiftTypes" [placeholder]="'common.placeholders.selectShiftTypes' | translate" optionLabel="label" optionValue="value"></p-multiSelect></div>

      </div>
    </p-panel>

    <div class="add-button-container">
        <p-button type="submit" [label]="(isEditMode ? 'common.buttons.update' : 'common.buttons.add') | translate" icon="pi pi-check" [loading]="isSubmitting"></p-button>
        <p-button type="button" [label]="'common.buttons.cancel' | translate" icon="pi pi-times" styleClass="p-button-secondary" (click)="onCancel()"></p-button>
    </div>

  </form>
</div>